Nausea <- data.frame(id=c(1,2,2,3,4),tox="Nausea",grade=as.character(c(1,3,2,2,3)),time=c(2,1,8,10,1.5))
Fever <- data.frame(id=c(4,5,5,3,3),tox="Fever",grade=as.character(c(1,2,2,1,2)), time=c(1.5,3,5.5,2,6))
Anemia <- data.frame(id=c(4,5,5,3,3),tox="Anemia",grade=as.character(c(1,1,2,1,3)), time=c(1.5,3,5,2,6))
###
swimmer_plot(df=d1,id='id',end='End_trt',name_fill='Arm',col="black")+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=3,name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=3,name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=3,name_shape = 'grade',stroke=3)+
scale_shape_manual(values=c("1","2","3"))
d1 <- data.frame(id=c(1,2,3,4,5),end=c(3.26,15.45,14.84,3.51,7.44))
Nausea <- data.frame(id=c(1,2,2,3,4),tox="Nausea",grade=as.character(c(1,3,2,2,3)),time=c(2,1,8,10,1.5))
Fever <- data.frame(id=c(4,5,5,3,3),tox="Fever",grade=as.character(c(1,2,2,1,2)), time=c(1.5,3,5.5,2,6))
Anemia <- data.frame(id=c(4,5,5,3,3),tox="Anemia",grade=as.character(c(1,1,2,1,3)), time=c(1.5,3,5,2,6))
###
swimmer_plot(df=d1,id='id',end='end',name_fill='Arm',col="black")+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=3,name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=3,name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=3,name_shape = 'grade',stroke=3)+
scale_shape_manual(values=c("1","2","3"))
###
swimmer_plot(df=d1,id='id',end='end',col="black")+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=3,name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=3,name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=3,name_shape = 'grade',stroke=3)+
scale_shape_manual(values=c("1","2","3"))
###
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=3,name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=3,name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=3,name_shape = 'grade',stroke=3)+
scale_shape_manual(values=c("1","2","3"))
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=3,name_col = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=3,name_col = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=3,name_col = 'grade',stroke=3)+
scale_color_manual(values=c("coral2","red3","orangered4"))
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=3,name_col = 'grade',name_shape = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=3,name_col = 'grade',name_shape = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=3,name_col = 'grade',name_shape = 'tox',stroke=3)+
scale_color_manual(values=c("coral2","red3","orangered4"))
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=3,name_col = 'grade',name_shape = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=3,name_col = 'grade',name_shape = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=3,name_col = 'grade',name_shape = 'tox',stroke=3)+
scale_color_manual(label="Grade",values=c("coral2","red3","orangered4"))
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=3,name_col = 'grade',name_shape = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=3,name_col = 'grade',name_shape = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=3,name_col = 'grade',name_shape = 'tox',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4"))
###
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=3,name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=3,name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=3,name_shape = 'grade',stroke=3)+
scale_shape_manual(values=c("1","2","3"))
###
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
scale_shape_manual(values=c("1","2","3"))
###
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
scale_shape_manual(values=c("1","2","3")) + theme(guides(shape=FALSE))
###
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
scale_shape_manual(values=c("1","2","3")) + theme(guides(shape=NULL))
###
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
scale_shape_manual(values=c("1","2","3")) + guides(shape=NULL)
###
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
scale_shape_manual(values=c("1","2","3")) + guides(shape=F)
###
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
scale_shape_manual(values=c("1","2","3")) + guides(shape=FALSE)
###
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
scale_shape_manual(values=c("1","2","3")) + guides(shape=FALSE)+
scale_color_brewer(palette = "Dark2")
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=3,name_col = 'grade',name_shape = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=3,name_col = 'grade',name_shape = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=3,name_col = 'grade',name_shape = 'tox',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4"))
###
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
scale_shape_manual(values=c("1","2","3")) + guides(shape=FALSE)+
scale_color_brewer(palette = "Dark2")
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=3,name_col = 'grade',name_shape = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=3,name_col = 'grade',name_shape = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=3,name_col = 'grade',name_shape = 'tox',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4"))
###
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=3,name_shape = 'grade',name_col = 'tox',stroke=3)+
scale_shape_manual(values=c("1","2","3")) + guides(shape=FALSE)+
scale_color_brewer(palette = "Dark2")
###
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_shape = 'grade',name_col = 'tox',stroke=3)+
scale_shape_manual(values=c("1","2","3")) + guides(shape=FALSE)+
scale_color_brewer(palette = "Dark2")
###
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_shape = 'grade',name_col = 'tox',stroke=3)+
scale_shape_manual(values=c("1","2","3")) + guides(shape=FALSE)+
scale_color_brewer(palette = "Dark2")
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_col = 'grade',name_shape = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_col = 'grade',name_shape = 'tox',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4"))
###
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_shape = 'grade',name_col = 'tox',stroke=3)+
scale_shape_manual(values=c("1","2","3")) + guides(shape=FALSE)+
scale_color_brewer(palette = "Dark2")
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_col = 'grade',name_shape = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_col = 'grade',name_shape = 'tox',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4"))
swimmer_text <- function(df_text,id='id',start='start',label='label',name_col=NULL,name_size=NULL,
name_alpha=NULL,name_fontface=NULL,adj.y=0,adj.x=0,...){
if(!start %in% colnames(df_text))  df_text[,start] <- 0
df_text[,id] <- as.character(df_text[,id])
plot.lines <-
ggplot2::geom_text(
data = df_text,
ggplot2::aes_string(
label=label,
x = id,
y = start,
col = name_col,
size = name_size,
alpha = name_alpha,
fontface =name_fontface
),hjust=0,position = ggplot2::position_nudge(x = adj.y, y = adj.x),...
)
return(plot.lines)
}
###
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_shape = 'grade',name_col = 'tox',stroke=3)+
scale_shape_manual(values=c("1","2","3")) + guides(shape=FALSE)+
scale_color_brewer(palette = "Dark2")
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_col = 'grade',name_shape = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_col = 'grade',name_shape = 'tox',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4"))
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4"))
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4")) + labs(shape="Grade")
textdf1 <- data.frame(id=unique(d1$id),label="Nausea")
textdf1
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4")) + labs(shape="Grade")+
swimmer_text(df_text = Nausea)
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4")) + labs(shape="Grade")+
swimmer_text(df_text = Nausea,label = 'label')
textdf1 <- data.frame(id=unique(d1$id),name="Nausea")
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4")) + labs(shape="Grade")+
swimmer_text(df_text = Nausea,name = 'label')
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4")) + labs(shape="Grade")+
swimmer_text(df_text = Nausea,label = 'name')
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4")) + labs(shape="Grade")+
swimmer_text(df_text = textdf1,label = 'label')
textdf1
textdf1 <- data.frame(id=unique(d1$id),label="Nausea")
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4")) + labs(shape="Grade")+
swimmer_text(df_text = textdf1,label = 'label')
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4")) + labs(shape="Grade")+
swimmer_text(df_text = textdf1,label = 'label',adj.x = -2)
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4")) + labs(shape="Grade")+
swimmer_text(df_text = textdf1,label = 'label',adj.x = -2.2)
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4")) + labs(shape="Grade")+
swimmer_text(df_text = textdf1,label = 'label',adj.x = -2.2,adj.y = 0.3)
textdf1 <- data.frame(id=unique(d1$id),label="Nausea")
textdf2 <- data.frame(id=unique(d1$id),label="Fever")
textdf3 <- data.frame(id=unique(d1$id),label="Anemia")
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4")) + labs(shape="Grade")+
swimmer_text(df_text = textdf1,label = 'label',adj.x = -2.2,adj.y = 0.3)+
swimmer_text(df_text = textdf2,label = 'label',adj.x = -2.2,adj.y = 0)+
swimmer_text(textdf3 = textdf1,label = 'label',adj.x = -2.2,adj.y = -0.3)
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4")) + labs(shape="Grade")+
swimmer_text(df_text = textdf1,label = 'label',adj.x = -2.2,adj.y = 0.3)+
swimmer_text(df_text = textdf2,label = 'label',adj.x = -2.2,adj.y = 0)+
swimmer_text(textdf3 = textdf3,label = 'label',adj.x = -2.2,adj.y = -0.3)
textdf1 <- data.frame(id=unique(d1$id),label="Nausea")
textdf2 <- data.frame(id=unique(d1$id),label="Fever")
textdf3 <- data.frame(id=unique(d1$id),label="Anemia")
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4")) + labs(shape="Grade")+
swimmer_text(df_text = textdf1,label = 'label',adj.x = -2.2,adj.y = 0.3)+
swimmer_text(df_text = textdf2,label = 'label',adj.x = -2.2,adj.y = 0)+
swimmer_text(textdf3 = textdf3,label = 'label',adj.x = -2.2,adj.y = -0.3)
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4")) + labs(shape="Grade")+
swimmer_text(df_text = textdf1,label = 'label',adj.x = -2.2,adj.y = 0.3)
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4")) + labs(shape="Grade")+
swimmer_text(df_text = textdf1,label = 'label',adj.x = -2.2,adj.y = 0.3)+
swimmer_text(df_text = textdf2,label = 'label',adj.x = -2.2,adj.y = 0)
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4")) + labs(shape="Grade")+
swimmer_text(df_text = textdf1,label = 'label',adj.x = -2.2,adj.y = 0.3)+
swimmer_text(df_text = textdf2,label = 'label',adj.x = -2.2,adj.y = 0)+
swimmer_text(df_text = textdf3,label = 'label',adj.x = -2.2,adj.y = -0.3)
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.2,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.2,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4")) + labs(shape="Grade")+
swimmer_text(df_text = textdf1,label = 'label',adj.x = -2.2,adj.y = 0.2)+
swimmer_text(df_text = textdf2,label = 'label',adj.x = -2.2,adj.y = 0)+
swimmer_text(df_text = textdf3,label = 'label',adj.x = -2.2,adj.y = -0.2)
d1 <- data.frame(id=c(1,2,3,4,5),end=c(3.26,15.45,14.84,3.51,7.44))
Nausea <- data.frame(id=c(1,2,2,3,4),tox="Nausea",grade=as.character(c(1,3,2,2,3)),time=c(2,1,8,10,1.5))
Fever <- data.frame(id=c(4,5,5,3,3),tox="Fever",grade=as.character(c(1,2,2,1,2)), time=c(1.5,3,5.5,2,6.5))
Anemia <- data.frame(id=c(4,5,5,3,3),tox="Anemia",grade=as.character(c(1,1,2,1,3)), time=c(1.5,3,5,2,6))
###
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_shape = 'grade',name_col = 'tox',stroke=3)+
scale_shape_manual(values=c("1","2","3")) + guides(shape=FALSE)+
scale_color_brewer(palette = "Dark2")
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_col = 'grade',name_shape = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_col = 'grade',name_shape = 'tox',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4"))
textdf1 <- data.frame(id=unique(d1$id),label="Nausea")
textdf2 <- data.frame(id=unique(d1$id),label="Fever")
textdf3 <- data.frame(id=unique(d1$id),label="Anemia")
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.2,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.2,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4")) + labs(shape="Grade")+
swimmer_text(df_text = textdf1,label = 'label',adj.x = -2.2,adj.y = 0.2)+
swimmer_text(df_text = textdf2,label = 'label',adj.x = -2.2,adj.y = 0)+
swimmer_text(df_text = textdf3,label = 'label',adj.x = -2.2,adj.y = -0.2)
d1 <- data.frame(id=c(1,2,3,4,5),end=c(3.26,15.45,14.84,3.51,7.44))
Nausea <- data.frame(id=c(1,2,2,3,4),tox="Nausea",grade=as.character(c(1,3,2,2,3)),time=c(2,1,8,10,1.5))
Fever <- data.frame(id=c(4,5,5,3,3),tox="Fever",grade=as.character(c(1,2,2,1,2)), time=c(1.5,3,6,2,6.5))
Anemia <- data.frame(id=c(4,5,5,3,3),tox="Anemia",grade=as.character(c(1,1,2,1,3)), time=c(1.5,3,5,2,6))
###
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_shape = 'grade',name_col = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_shape = 'grade',name_col = 'tox',stroke=3)+
scale_shape_manual(values=c("1","2","3")) + guides(shape=FALSE)+
scale_color_brewer(palette = "Dark2")
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.3,size=4,name_col = 'grade',name_shape = 'tox',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'tox',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.3,size=4,name_col = 'grade',name_shape = 'tox',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4"))
textdf1 <- data.frame(id=unique(d1$id),label="Nausea")
textdf2 <- data.frame(id=unique(d1$id),label="Fever")
textdf3 <- data.frame(id=unique(d1$id),label="Anemia")
swimmer_plot(df=d1,id='id',end='end',col="black",fill='white')+
swimmer_points(df_points=Nausea,id='id',time='time',adj.y = 0.2,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Fever,id='id',time='time',adj.y = 0,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
swimmer_points(df_points=Anemia,id='id',time='time',adj.y = -0.2,size=4,name_col = 'grade',name_shape = 'grade',stroke=3)+
scale_color_manual(name="Grade",values=c("coral2","red3","orangered4")) + labs(shape="Grade")+
swimmer_text(df_text = textdf1,label = 'label',adj.x = -2.2,adj.y = 0.2)+
swimmer_text(df_text = textdf2,label = 'label',adj.x = -2.2,adj.y = 0)+
swimmer_text(df_text = textdf3,label = 'label',adj.x = -2.2,adj.y = -0.2)
devtools::document()
rm(list = c("line_df_to_point_df", "swimmer_arrows", "swimmer_lines", "swimmer_plot", "swimmer_points", "swimmer_points_from_lines", "swimmer_text"))
devtools::document()
devtools::build()
library(ggplot2)
library(ggpattern)
unloadNamespace("ggpattern")
unloadNamespace("ggplot2")
df <- data.frame(level = c('a','b','c','d'), outcome = c(2.3, 1.9, 3.2, 1))
ggplot2::ggplot(df) +
ggpattern::geom_col_pattern(
ggplot2::aes(level, outcome,fill=level,pattern_fill=level))
unloadNamespace("ggpattern")
library(ggpattern)
ggplot2::ggplot(df) +
ggpattern::geom_col_pattern(
ggplot2::aes(level, outcome,fill=level,pattern_fill=level))
a <- ggplot2::ggplot(df) +
ggpattern::geom_col_pattern(
ggplot2::aes(level, outcome,fill=level,pattern_fill=level))
summary(a)
unloadNamespace("ggpattern")
a <- ggplot2::ggplot(df) +
ggpattern::geom_col_pattern(
ggplot2::aes(level, outcome,fill=level,pattern_fill=level))
summary(a)
a
b <- ggplot2::ggplot(df) +
ggpattern::geom_col_pattern(
ggplot2::aes(level, outcome,fill=level,pattern_fill=level))
summary(a)
b
library(ggpattern)
a <- ggplot2::ggplot(df) +
ggpattern::geom_col_pattern(
ggplot2::aes(level, outcome,fill=level,pattern_fill=level))
a
b
b
ggpattern::b
ggplot(b)
a
unloadNamespace("ggpattern")
a
print(a)
ggpattern::print(a)
unloadNamespace("ggpattern")
print(a)
library(ggpattern)
print(a)
?print
base::print(a)
base::print(a)
a
a
d <- data.frame(id=c(1,2,3,4,5,6,6,6),end=c(1,2,3,4,5,2,4,6),treatment=c('a','b','ab','a','ab','b','ab','a'))
d$treatment <- factor(d$treatment)
swim_plot_pattern(df=d,name_fill = 'treatment',name_pattern='treatment',name_pattern_fill = 'treatment',col='black',pattern_density=0.5)+
ggpattern::scale_pattern_manual(values =c(a='none',ab='stripe',b='none'),breaks = c('a','b','ab'))+
ggpattern::scale_pattern_fill_manual(values=c(a='pink',ab='pink',b='lightblue')) +
scale_fill_manual(values=c(a='pink',ab='lightblue',b='lightblue'),breaks=c('a','b'))+
guides(fill = guide_legend(override.aes = list(pattern = 'none')),pattern=F,pattern_fill=F)
swim_plot_pattern <- function(df,id='id',end='end',name_fill=NULL,name_col=NULL,name_pattern=NULL,name_pattern_fill=NULL,id_order = 'increasing',stratify=FALSE,base_size=11,...)
{
df[,id] <- as.character(df[,id])
max_time <- stats::aggregate(df[,end], by = list(df[,id]), max)
names(max_time) <- c(id,end)
if (id_order[1] == 'increasing') {
id_order <-  suppressMessages(unlist(c(df %>%
dplyr::group_by(!!dplyr::sym(id))  %>%
dplyr::summarise(max_time=max(!!dplyr::sym(end)))  %>%
dplyr::arrange(max_time)  %>%
dplyr::select(!!dplyr::sym(id)))))
}
if (id_order[1] == 'decreasing') {
id_order <-  suppressMessages(unlist(c(df %>%
dplyr::group_by(!!dplyr::sym(id))  %>%
dplyr::summarise(max_time=max(!!dplyr::sym(end)))  %>%
dplyr::arrange(dplyr::desc(max_time))  %>%
dplyr::select(!!dplyr::sym(id)))))
}
if (id_order[1] %in% names(df)) {
id_order <- suppressMessages(unlist(c(df %>%
dplyr::group_by(!!dplyr::sym(id))  %>%
dplyr::mutate(max_time=max(!!dplyr::sym(end))) %>%
dplyr::top_n(-1,!!dplyr::sym(end))%>%
dplyr::arrange( dplyr::desc(!!dplyr::sym(id_order)),max_time) %>%
dplyr::select(!!dplyr::sym(id)))))
}
start = 'starting_bars_variable'
df <- df %>%
dplyr::arrange(!!dplyr::sym(id),!!dplyr::sym(end)) %>%
dplyr::group_by(!!dplyr::sym(id))%>%
dplyr::mutate(temporary_end=!!dplyr::sym(end)-dplyr::lag(!!dplyr::sym(end)))%>%
dplyr::mutate(starting_bars_variable= dplyr::lag(!!dplyr::sym(end)))%>%
dplyr::mutate(!!dplyr::sym(end):=ifelse(is.na(temporary_end),!!dplyr::sym(end),temporary_end))%>%
dplyr::mutate(starting_bars_variable=ifelse(is.na(starting_bars_variable),0,starting_bars_variable))%>%
dplyr::select(-temporary_end)
# if(is.null(name_fill) & is.null(name_col)) {
#   df <- max_time
#   df[,start] <- 0
#
# }
df <- data.frame(df)
starting_times <- sort(unique(df[,start]),decreasing = TRUE)
df[,start] <- factor(df[,start],starting_times)
df[, id] <- factor(df[, id], levels = id_order)
plot <-
ggplot2::ggplot(df) +
ggpattern::geom_col_pattern(position = "stack",
ggplot2::aes_string(fill = name_fill,col = name_col,pattern=name_pattern,pattern_fill=name_pattern_fill, group = start,x = id, y = end),...) + ggplot2::coord_flip() +
ggplot2::theme_bw(base_size = base_size) +
ggplot2::theme(panel.grid.minor = ggplot2::element_blank(),panel.grid.major = ggplot2::element_blank())
if(stratify[1]!=FALSE) plot <-  plot + ggplot2::facet_wrap(stats::as.formula(paste("~",paste(stratify,collapse = "+"))),scales = "free_y")+
ggplot2::theme(strip.background = ggplot2::element_rect(colour="black", fill="white"))
return(plot)
}
d <- data.frame(id=c(1,2,3,4,5,6,6,6),end=c(1,2,3,4,5,2,4,6),treatment=c('a','b','ab','a','ab','b','ab','a'))
d$treatment <- factor(d$treatment)
swim_plot_pattern(df=d,name_fill = 'treatment',name_pattern='treatment',name_pattern_fill = 'treatment',col='black',pattern_density=0.5)+
ggpattern::scale_pattern_manual(values =c(a='none',ab='stripe',b='none'),breaks = c('a','b','ab'))+
ggpattern::scale_pattern_fill_manual(values=c(a='pink',ab='pink',b='lightblue')) +
scale_fill_manual(values=c(a='pink',ab='lightblue',b='lightblue'),breaks=c('a','b'))+
guides(fill = guide_legend(override.aes = list(pattern = 'none')),pattern=F,pattern_fill=F)
library(dplyr)
swim_plot_pattern(df=d,name_fill = 'treatment',name_pattern='treatment',name_pattern_fill = 'treatment',col='black',pattern_density=0.5)+
ggpattern::scale_pattern_manual(values =c(a='none',ab='stripe',b='none'),breaks = c('a','b','ab'))+
ggpattern::scale_pattern_fill_manual(values=c(a='pink',ab='pink',b='lightblue')) +
scale_fill_manual(values=c(a='pink',ab='lightblue',b='lightblue'),breaks=c('a','b'))+
guides(fill = guide_legend(override.aes = list(pattern = 'none')),pattern=F,pattern_fill=F)
library(ggplot2)
swim_plot_pattern(df=d,name_fill = 'treatment',name_pattern='treatment',name_pattern_fill = 'treatment',col='black',pattern_density=0.5)+
ggpattern::scale_pattern_manual(values =c(a='none',ab='stripe',b='none'),breaks = c('a','b','ab'))+
ggpattern::scale_pattern_fill_manual(values=c(a='pink',ab='pink',b='lightblue')) +
scale_fill_manual(values=c(a='pink',ab='lightblue',b='lightblue'),breaks=c('a','b'))+
guides(fill = guide_legend(override.aes = list(pattern = 'none')),pattern=F,pattern_fill=F)
devtools::document()
devtools::document()
devtools::document()
rm(list = c("swim_plot_pattern")
)
devtools::build()
library(swimplot)
remove.packages("swimplot", lib="~/R/R-4.0.2/library")
